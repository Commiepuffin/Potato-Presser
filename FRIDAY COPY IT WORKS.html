<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Potato Presser</title>
    <style>
        #error {
            color: red;
            position: absolute;
            float: right;
            left: 85%;
            top: 10px;
        }
    </style>
</head>

<body>

    <h1 id="output"></h1>
    <h2 id="potatoesPerSecond"></h2>
    <h3 id="stopWatch">you have been harvesting potatoes for 0 seconds</h3>
    <img id="potato" src="https://freepngdownload.com/image/thumb/potato-png-free-download-12.png" width="400"
        alt="potato">
    <div id="display"></div>
    <!--<h3 id="error">You dont have enough potatoes</h3>
    <h3>Buy upgrades to increase your potato farming power</h3>
    <button id="worker">Common workers-price: 1 potato</button>
    <h4 id= "workerText"></h4>
    <button id="tractor">Buy some tractors-price: 25 potatoes</button>
    <h4 id="tractorText"></h4>
    <button id="wheelbarrow">Wheelbarrows for sale only: 150 potatoes</button>
    <h4 id="wheelbarrowText"></h4>>-->




    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

    <script>
        function buyable(name, id, count, price, pps, multiplier, production, flavor) {
            this.name = name;
            this.id = id;
            this.count = count;
            this.price = price;
            //this.finalPrice = finalPrice;
            //this.regulator = regulator;
            this.pps = pps;
            this.multiplier = multiplier;
            this.production = production;
            this.flavor = flavor;
            this.functionName = "obj"+name.charAt(0).toUpperCase() + name.slice(1);
            var buttonText = function () {
                return (name + "-price: " + price + " potato");
            }
            this.processClick = function () {
                console.log("firing " + this.id);
                console.log("you have " + potatoCounter + " taters");
                console.log(this.name + " cost " + this.price);
                if (potatoCounter >= price) {
                    potatoCounter -= price;
                    price += ((count * multiplier) / price);
                    price.toFixed(0);
                    count++;
                    finalPotatoes = potatoCounter.toFixed(0);
                    pps = (count * production).toFixed(1);
                    $("#" + id).html = buttonText();
                    console.log("WE GOT HERE");
                }
            }


            this.buttonCode = "<button id=\"" + this.id + "Btn\" onClick = \"" + this.functionName + ".processClick()\">" + buttonText() + "</button><br>";
            var flavorText = function () {
                return ("you have " + count + " " + flavor);
            }
            this.flavorCode = "<span id =\"" + this.id + "\">" + flavorText() + "</span><br>";
        }

        const objWorker = new buyable('worker', 'worker', 0, 1, 0, 4, .5, 'loyal workers');
        const objTractor = new buyable('tractor', 'tractor', 0, 25, 0, 10, 4 / 3, 'rusty tractors');

        var buyables = [objWorker, objTractor]
        var $potatoes = $('#output');
        var $error = $('#error');
        var potatoCounter = 0;
        var time = 0;

        //// SETUP CODE________________________________________________________________________________________________________________________________________________________________________
        for (b in buyables) {
            $("#display").append(buyables[b].buttonCode);
            $("#display").append(buyables[b].flavorCode);
            console.log(buyables[b].flavorCode);
        }

        //        $error.hide();
        $potatoes.text("press the potato to begin harvesting")

        $("#potato").on("click", function (event) {
            potatoCounter++;
            finalPotatoes = potatoCounter.toFixed(0);
            $potatoes.text("you have harvested " + finalPotatoes + " potatoes")
            $error.hide();

        });

        var fireButton = function (btn) {

        }


        var i = 1;
        var timer = function (e) {
            setInterval(function () {
                i++;
                var time = (i / 60);
                finalTime = time.toFixed(0);
                finalPotatoes = potatoCounter.toFixed(0);
                $potatoes.text("you have harvested " + finalPotatoes + " potatoes")
                $("#stopWatch").html("you have been harvesting potatoes for " + finalTime + " seconds");
            }, (1000 / 60));
        }
        timer();

    </script>

</body>

</html>