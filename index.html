<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Potato Presser</title>
    <style>

    </style>
</head>

<body>
    <h1 id=potatoes>You have harvested 0 potatoes</h1>
    <h3 id=stopWatch>Click the potato to begin harvesting.</h3>
    <img id="potato" src="https://freepngdownload.com/image/thumb/potato-png-free-download-12.png" width="400"
        alt="potato">
    <div id="help"> </div>
    <p id=error> oops you are poor </p>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

    <script>
        var $error = $('#error')
        $error.hide();
        var potatoCounter = 0;
        var a = 0;
        function buyable(name, price, production, flavor) {
            var counter = 0;
            this.counter = counter;
            this.name = name;
            this.price = price;
            this.flavor = flavor;
            this.functionName = "obj" + name.charAt(0).toUpperCase() + name.slice(1);
            this.ppsOut = 0;
            this.onClick = function () {
                console.log("firing")
                if (potatoCounter >= price) {
                    potatoCounter -= price;
                    counter++;
                    (price += (price * price/ (counter *(price/2))))
                    price.toFixed(0)
                    
                    $("#" + name + "Btn").text(buttonText())
                    $("#" + name + "Flavor").text(flavorText())
                    ppsOut = pps();
                    console.log(ppsOut)
                } else $error.show();

            }
            var buttonText = function () {
                return (price)
            }
            this.buttonCode = "<button id=\"" + this.name + "Btn\" onClick = \"" + this.functionName + ".onClick()\">" + buttonText() + "</button><br>";
            var updater = function () {
                return (counter);
            }
            var pps = function () {
                return ((counter * production).toFixed(1))
            }
            var flavorText = function () {
                return ("you have " + updater() + " " + flavor + " " + name + "s. producing " + pps() + " potatoes per second")
            }
            this.flavorCode = "<span id =\"" + this.name + "Flavor\">" + flavorText() + "</span><br>";


            // this.ppsCode = "<span id =\"" + this.name + "Pps\">" + pps() + "</span><br>";


        }
        const objWorker = new buyable('worker', 1, .1, 'loyal')
        const objTractor = new buyable('tractor', 25, .5, 'rusty')

        var buyables = [objWorker, objTractor]
        console.log(buyables)

        for (b in buyables) {
            $("#help").append(buyables[b].buttonCode)
            $("#help").append(buyables[b].flavorCode)
        }
        
        $("#potato").on("click", function (event) {
            a++;
            potatoCounter++;
            potatoCounter.toFixed(0);
            $("#potatoes").text("you have harvested " + potatoCounter + " potatoes")
            $error.hide();
        });


        var i = 1;

        var timer = function (e) {
            setInterval(function () {
                i++;
                var time = (i / 60);
                finalTime = time.toFixed(0);
                console.log(ppsOut);
                for (b in buyables) {
                     potatoCounter += (ppsOut/ 60);
                  }
                finalPotatoes = potatoCounter.toFixed(0);
                $("#potatoes").text("you have harvested " + finalPotatoes + " potatoes")
                $("#stopWatch").text("you have been harvesting potatoes for " + finalTime + " seconds");
                //  console.log(finalTime)
            }, (1000 / 60));
        }
            timer();
        
    </script>

</body>

</html>